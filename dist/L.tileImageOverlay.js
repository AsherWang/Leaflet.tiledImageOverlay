L.TileImageOverlay=L.LayerGroup.extend({initialize:function(t){(this._opts=t).width=t.width||t.blockSize*t.col,t.height=t.height||t.blockSize*t.row;for(var o=t.blockSize,i=[],a=0;a<t.row;a+=1)for(var e=0;e<t.col;e+=1){var s=t.tileUrl.replace("{x}",t.startX+e).replace("{y}",t.startY+a).replace("{z}",t.z),h=[[-o*a,o*e],[-o*(a+1),o*(e+1)]];i.push(L.imageOverlay(s,h))}L.LayerGroup.prototype.initialize.call(this,i),this.on("add",function(){t.autoFit&&this._autoFit()})},_autoFit:function(){map=this._map;var t=[[0,0],[-this._opts.height,this._opts.width]],o=[-this._opts.height/2,this._opts.width/2],i=Math.min(Math.abs(t[0][0]-t[1][0]),Math.abs(t[0][1]-t[1][1]))/2,a=[[o[0]+i,o[1]-i],[o[0]-i,o[1]+i]],e=map.getBoundsZoom(a,!0),s=map.getBoundsZoom(t,!1),h=Math.max(e,s+3);if(this._opts.onAutoFit){var r={minZoom:s,z:e,maxZoom:h,center:o,maxBounds:t};this._opts.onAutoFit(r)}else map.setView(o,e).setMaxBounds(t).setMinZoom(s).setMaxZoom(h);this._opts.debug&&(L.marker(o).addTo(map),this._addPolygon(t),this._addPolygon(a,"blue"))},_addPolygon:function(t,o){o=o||"red";var i=t[0],a=t[1],e=[i,[i[0],a[1]],a,[a[0],i[1]]];L.polygon(e,{color:o}).addTo(this._map)}}),L.tileImageOverlay=function(t){return new L.TileImageOverlay(t)};